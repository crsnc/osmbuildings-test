<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Otel HaritasÄ± 3D</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.osmbuildings.org/4.0.0/OSMBuildings.js"></script>
<style>
  body, html{margin:0;padding:0;height:100%;}
  #map{width:100%;height:100%;}
  .panel{position:absolute;top:12px;left:50%;transform:translateX(-50%);z-index:1000;background:#fff;padding:10px;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.2);}
  .panel input[type="search"]{padding:6px;width:200px;}
  .panel button{margin-left:6px;padding:6px;}
</style>
</head>
<body>
<div id="map"></div>

<div class="panel">
  <input id="searchBox" type="search" placeholder="Ara: restoran, spa, havuzâ€¦"/>
  <button id="searchBtn">Git</button>
  <button id="pickBtn">Haritadan Hedef</button>
  <button id="followBtn">ðŸŽ¯ Ä°zle</button>
</div>

<script>
// ===== Resepsiyon koordinatlarÄ± =====
const resepsiyon = { lat: 36.6005, lng: 31.8050 };

// ===== Harita =====
const map = L.map('map').setView([resepsiyon.lat, resepsiyon.lng], 18);

// OpenStreetMap katmanÄ±
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'Â© OpenStreetMap contributors'
}).addTo(map);

// ===== OSMBuildings =====
const osmb = new OSMBuildings(map).load();

// ===== KullanÄ±cÄ± konumu =====
let userMarker = null;
let following = false;
function enableFollow() {
  if(!navigator.geolocation) return alert("Konum bulunamadÄ±.");
  if(!userMarker){
    userMarker = L.circleMarker([0,0], {radius:7,color:'#1d4ed8',fillColor:'#1d4ed8',fillOpacity:0.8}).addTo(map);
  }
  following = true;
  navigator.geolocation.watchPosition(pos=>{
    const latlng = [pos.coords.latitude, pos.coords.longitude];
    userMarker.setLatLng(latlng);
    if(following) map.setView(latlng, map.getZoom());
  }, err=>{}, {enableHighAccuracy:true});
}

// ===== Arama ve hedef =====
const pickBtn = document.getElementById('pickBtn');
const followBtn = document.getElementById('followBtn');
const searchBtn = document.getElementById('searchBtn');
const searchBox = document.getElementById('searchBox');

let targetMarker = null;
let pickMode = false;

pickBtn.onclick = ()=>{ pickMode = !pickMode; pickBtn.classList.toggle('active', pickMode); };
map.on('click', e=>{
  if(pickMode){
    if(targetMarker) map.removeLayer(targetMarker);
    targetMarker = L.marker(e.latlng,{icon:L.icon({iconUrl:'https://cdn-icons-png.flaticon.com/512/684/684908.png',iconSize:[25,25]})}).addTo(map);
    pickMode=false; pickBtn.classList.remove('active');
  }
});

followBtn.onclick = ()=>{ enableFollow(); };

// Basit arama: haritada marker gÃ¶ster
searchBtn.onclick = ()=>{
  const query = searchBox.value.trim().toLowerCase();
  if(!query) return alert("Bir ÅŸeyler yazÄ±n!");
  // Ã–rnek: resepsiyon iÃ§in
  if(query.includes('resepsiyon')){
    map.setView([resepsiyon.lat, resepsiyon.lng], 18);
    alert("Resepsiyon bulundu!");
  }
  // Daha fazla nokta eklemek istersen burada kontrol ekleyebilirsin
};

</script>
</body>
</html>
